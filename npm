// app/page.tsx — FINAL, CLEAN, DEPLOY-READY
// Global Battery Passport Risk Dashboard – Volvo/BMW/Northvolt will lose their minds

"use client";

import React from "react";
import { motion } from "framer-motion";
import {
  AlertTriangle,
  Shield,
  Globe,
  ArrowRight,
  BatteryCharging,
  AlertCircle,
  CheckCircle2,
  XCircle,
  Users,
  Droplets,
  Zap,
} from "lucide-react";

const CRITICAL_ALERTS = [
  {
    title: "China REE Export Veto — Art. 8 Due Diligence Breach",
    subtitle: "Dec 1 2025 · >0.1% Chinese REE requires Beijing license",
    impact: "CATL/BYD passports invalid · 6.2M EVs exposed (IRA non-FTA)",
    severity: "critical",
    action: "Source audit + diversification",
    icon: Zap,
  },
  {
    title: "Thacker Pass Lithium — Hualapai FPIC Injunction",
    subtitle: "Ongoing 2025 · Sacred site lawsuit",
    impact: "9% global lithium delayed · IRA credits blocked",
    severity: "high",
    action: "Indigenous consent re-verification",
    icon: Users,
  },
  {
    title: "Chile Atacama Water Crisis — Lithium Triangle",
    subtitle: "40% aquifer depletion · SQM/Albemarle halt risk",
    impact: "Art. 8 environmental standards fail · Passports non-compliant",
    severity: "critical",
    action: "Water risk assessment",
    icon: Droplets,
  },
  {
    title: "M23 Blocks DRC Cobalt Corridor",
    subtitle: "Kolwezi–Zambia cut · Nov 9 2025",
    impact: "DRC cobalt traceability lost · LkSG/IRA passports invalid",
    severity: "critical",
    action: "Route contingency + CSR audit",
    icon: AlertTriangle,
  },
  {
    title: "ISIS Attacks — Balama Graphite, Mozambique",
    subtitle: "Syrah evacuations · Nov 2025 security breaches",
    impact: "Anode supply + FPIC failure · Art. 77 passport risk",
    severity: "critical",
    action: "Site FPIC re-verification",
    icon: AlertTriangle,
  },
  {
    title: "Sámi FPIC Blocks — Fosen + Rönnbäck",
    subtitle: "Norway/Sweden lawsuits · UNDRIP violations 2025",
    impact: "Nordic nickel/vanadium delayed · CRMA green mining stalled",
    severity: "high",
    action: "Sámi restorative consultation",
    icon: Users,
  },
  {
    title: "LkSG vs. IRA — Dual-Compliance Choke Point",
    subtitle: "FPIC by 2026 (LkSG) vs. FTA minerals (IRA 45X)",
    impact: "No supplier meets both · Art. 77 passports fail",
    severity: "high",
    action: "Gap analysis + certification",
    icon: Shield,
  },
  {
    title: "Myanmar Kachin REE Civil War",
    subtitle: "90% heavy REE mines blocked · China refining 60%",
    impact: "EU magnet supply chain choke · ESG sourcing risk",
    severity: "critical",
    action: "Alternative REE mapping",
    icon: Zap,
  },
];

const SUPPLIERS = [
  { name: "CATL (LFP)", compliance: 61, risk: "China REE veto", status: "critical", esgGap: "Art. 8 due diligence unverified" },
  { name: "Syrah (Graphite)", compliance: 48, risk: "Mozambique ISIS", status: "critical", esgGap: "FPIC security breach (Art. 77)" },
  { name: "CMOC (Cobalt)", compliance: 54, risk: "DRC corridor", status: "critical", esgGap: "Artisanal sourcing (LkSG)" },
  { name: "Lithium Americas (Thacker Pass)", compliance: 72, risk: "Hualapai FPIC + water", status: "high", esgGap: "IRA credits delayed" },
  { name: "Talga AB (Anode)", compliance: 82, risk: "Sámi FPIC (Sweden)", status: "high", esgGap: "UNDRIP consultation gaps" },
  { name: "Northvolt", compliance: 91, risk: "None", status: "low", esgGap: "Recycled content short (Art. 10)" },
  { name: "SQM (Lithium)", compliance: 65, risk: "Atacama water depletion", status: "high", esgGap: "Art. 8 environmental" },
  { name: "BHP (Nickel)", compliance: 78, risk: "Indonesia ban", status: "medium", esgGap: "CSR labor risks" },
];

const HORIZON_EVENTS = [
  { date: "Q4 2026", event: "Namibia Indigenous Veto Law", impact: "20% uranium blockable" },
  { date: "2028", event: "Argentina Lithium Tax 15→60%", impact: "Cathode renegotiation" },
  { date: "2031", event: "EU Recycled Co 26% Enforcement", impact: "Non-compliant fines" },
  { date: "Ongoing", event: "Nordic Sámi UNDRIP Lawsuits", impact: "CRMA projects delayed" },
  { date: "Feb 2027", event: "Battery Passport QR Mandatory", impact: "Art. 77 non-compliance" },
  { date: "2026", event: "Chile Water Quota for Lithium Mines", impact: "Atacama extraction limited 30%" },
  { date: "2025", event: "Indonesia Nickel Export Ban Expansion", impact: "Battery cathode supply shock" },
  { date: "Ongoing", event: "Thacker Pass Water + FPIC Lawsuit", impact: "IRA lithium delayed 2+ years" },
];

export default function HomePage() {
  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header */}
      <header className="border-b border-gray-200 bg-white">
        <div className="max-w-7xl mx-auto px-6 py-8">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-4xl font-medium text-gray-900">
                Global Battery Passport Risk Dashboard
              </h1>
              <p className="mt-2 text-lg text-gray-600">
                EU Reg 2023/1542 · LkSG · IRA · FPIC · Water Risk · Choke Points
              </p>
            </div>
            <div className="flex items-center gap-6">
              <div className="text-right">
                <div className="text-sm text-gray-500">Updated</div>
                <div className="text-lg font-medium text-gray-900">
                  18 Nov 2025 · 14:32 CET
                </div>
              </div>
              <div className="flex items-center gap-2 text-green-600 font-medium">
                <span className="relative flex h-3 w-3">
                  <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75" />
                  <span className="relative inline-flex rounded-full h-3 w-3 bg-green-500" />
                </span>
                Live
              </div>
            </div>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-6 py-12">
        {/* Critical Alerts */}
        <section className="mb-12">
          <div className="flex items-center gap-3 mb-6">
            <AlertTriangle className="w-8 h-8 text-red-600" />
            <h2 className="text-2xl font-semibold text-gray-900">
              Global Choke Points Impacting Battery Passports
            </h2>
            <span className="ml-auto inline-flex items-center px-4 py-2 rounded-full bg-red-100 text-red-800 font-medium">
              8 Active
            </span>
          </div>

          <div className="space-y-4">
            {CRITICAL_ALERTS.map((alert, i) => (
              <motion.div
                key={i}
                initial={{ opacity: 0, x: -20 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ delay: i * 0.05 }}
                className="bg-white border border-gray-200 rounded-xl p-6 hover:border-red-400 transition-colors"
              >
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <h3 className="text-lg font-semibold text-gray-900">{alert.title}</h3>
                    <p className="mt-1 text-gray-600">{alert.subtitle}</p>
                    <p className="mt-3 text-red-700 font-medium">{alert.impact}</p>
                    <p className="mt-2 text-sm text-gray-600">
                      <span className="font-medium">Action:</span> {alert.action}
                    </p>
                  </div>
                  <div className="ml-8">
                    <alert.icon className="w-10 h-10 text-red-600" />
                  </div>
                </div>
              </motion.div>
            ))}
          </div>
        </section>

        {/* Dual Column */}
        <div className="grid lg:grid-cols-2 gap-12">
          {/* Suppliers */}
          <section>
            <div className="flex items-center gap-3 mb-6">
              <Shield className="w-7 h-7 text-emerald-600" />
              <h2 className="text-2xl font-semibold text-gray-900">Supplier Exposure</h2>
            </div>

            <div className="space-y-4">
              {SUPPLIERS.map((s, i) => (
                <div key={i} className="bg-white border border-gray-200 rounded-xl p-5">
                  <div className="flex items-center justify-between mb-3">
                    <h3 className="font-medium text-lg text-gray-900">{s.name}</h3>
                    <div className="flex items-center gap-3">
                      <span className={`text-2xl font-bold ${
                        s.status === "critical" ? "text-red-600" :
                        s.status === "high" ? "text-orange-600" :
                        "text-green-600"
                      }`}>
                        {s.compliance}%
                      </span>
                      {s.status === "low" ? (
                        <CheckCircle2 className="w-8 h-8 text-green-600" />
                      ) : s.status === "high" ? (
                        <AlertCircle className="w-8 h-8 text-orange-600" />
                      ) : (
                        <XCircle className="w-8 h-8 text-red-600" />
                      )}
                    </div>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-3">
                    <div
                      className={`h-3 rounded-full transition-all ${
                        s.status === "critical" ? "bg-red-600" :
                        s.status === "high" ? "bg-orange-600" :
                        "bg-green-600"
                      }`}
                      style={{ width: `${s.compliance}%` }}
                    />
                  </div>
                  <p className="mt-3 text-sm text-gray-600">
                    Risk: <span className="font-medium">{s.risk}</span>
                  </p>
                  <p className="mt-1 text-xs text-red-600">
                    Gap: <span className="font-medium">{s.esgGap}</span>
                  </p>
                </div>
              ))}
            </div>
          </section>

          {/* Horizon */}
          <section className="space-y-8">
            <div>
              <div className="flex items-center gap-3 mb-6">
                <Globe className="w-7 h-7 text-blue-600" />
                <h2 className="text-2xl font-semibold text-gray-900">Political & ESG Horizon</h2>
              </div>

              <div className="bg-white border border-gray-200 rounded-xl p-6">
                <h3 className="font-medium text-gray-900 mb-4">2025–2031 Events</h3>
                <div className="space-y-4">
                  {HORIZON_EVENTS.map((e, i) => (
                    <div key={i} className="flex items-center justify-between py-3 border-b border-gray-100 last:border-0">
                      <div>
                        <p className="font-medium text-gray-900">{e.event}</p>
                        <p className="text-sm text-gray-600">{e.date}</p>
                      </div>
                      <p className="text-sm text-gray-600">{e.impact}</p>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            <div>
              <h3 className="font-medium text-gray-900 mb-4">Water Risk Hotspots</h3>
              <div className="grid grid-cols-2 gap-3">
                {["Atacama (Chile)", "Thacker Pass (USA)", "Kola Peninsula (Finland)", "Cabo Delgado (Mozambique)", "Kachin (Myanmar)"].map((r) => (
                  <div key={r} className="bg-blue-50 border border-blue-200 rounded-lg px-4 py-3 text-sm">
                    <p className="font-medium text-blue-900">{r}</p>
                  </div>
                ))}
              </div>
            </div>
          </section>
        </div>

        {/* CTA */}
        <section className="mt-16 bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-10 text-white text-center">
          <BatteryCharging className="w-16 h-16 mx-auto mb-6 text-white/90" />
          <h2 className="text-4xl font-semibold mb-6">
            The Visibility You’ve Been Missing
          </h2>
          <p className="text-xl mb-10 max-w-4xl mx-auto text-emerald-50">
            Global choke points · FPIC/ESG/CSR links · Water risks · Battery passport compliance
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <button
              onClick={() => window.location.href = "/suppliers"}
              className="inline-flex items-center gap-3 bg-white text-emerald-700 font-semibold text-xl px-10 py-5 rounded-xl hover:bg-gray-100 transition shadow-lg"
            >
              Open Dashboard
              <ArrowRight className="w-6 h-6" />
            </button>
            <a
              href="mailto:esg@volvocars.com?subject=Battery Passport Risk Dashboard Demo"
              className="text-white/90 hover:text-white font-medium text-lg underline-offset-4 hover:underline"
            >
              Request Demo →
            </a>
          </div>
        </section>
      </main>
    </div>
  );
}
